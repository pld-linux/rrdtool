--- rrdtool-2003-12-11/src/Makefile.am.orig	Mon Jul 28 23:59:22 2003
+++ rrdtool-2003-12-11/src/Makefile.am	Thu Dec 11 12:52:39 2003
@@ -4,33 +4,33 @@
 #
 #ACLOCAL_M4	   = $(top_srcdir)/config/aclocal.m4
 #AUTOHEADER = @AUTOHEADER@ --localdir=$(top_srcdir)/config
-DEFS += -DMAKE_TIMESTAMP=\""$(shell date)"\"
+AM_CPPFLAGS = -DMAKE_TIMESTAMP=\""$(shell date)"\"
 if USE_INSTALLED_libcgi
-CGI_LIB 	   = -lcgi
+CGI_LIB 	   = -l$(installed_libcgi_lib)
 else
 CGI_LIB	           = $(top_builddir)/libraries/@CGI_LIB_DIR@/librrd_cgi.la
 CGI_INCLUDES       = -I$(top_srcdir)/libraries/@CGI_LIB_DIR@
 endif
 if USE_INSTALLED_libfreetype
-FREETYPE_LIB       = -lfreetype
+FREETYPE_LIB       = -l$(installed_libfreetype_lib)
 else
 FREETYPE_LIB       = $(top_builddir)/libraries/@FREETYPE_LIB_DIR@/librrd_freetype.la
 FREETYPE_INCLUDES  = -I$(top_srcdir)/libraries/@FREETYPE_LIB_DIR@/include
 endif
 if USE_INSTALLED_libart_lgpl
-ART_LIB            = -lart_lgpl
+ART_LIB            = -l$(installed_libart_lgpl_lib)
 else
 ART_LIB 	   = $(top_builddir)/libraries/@ART_LIB_DIR@/librrd_art.la
 ART_INCLUDES       = -I$(top_srcdir)/libraries/@ART_LIB_DIR@ -I$(top_builddir)/libraries/@ART_LIB_DIR@
 endif
 if USE_INSTALLED_libpng
-PNG_LIB            = -lpng
+PNG_LIB            = -l$(installed_libpng_lib)
 else
 PNG_LIB		   = $(top_builddir)/libraries/@PNG_LIB_DIR@/librrd_png.la
 PNG_INCLUDES       = -I$(top_srcdir)/libraries/@PNG_LIB_DIR@
 endif
 if USE_INSTALLED_libz
-ZLIB_LIB           = -lz
+ZLIB_LIB           = -l$(installed_libz_lib)
 else
 ZLIB_LIB           = $(top_builddir)/libraries/@ZLIB_LIB_DIR@/librrd_z.la
 ZLIB_INCLUDES      = -I$(top_srcdir)/libraries/@ZLIB_LIB_DIR@
--- rrdtool-2003-12-11/acinclude.m4.orig	Thu Jan 31 23:44:34 2002
+++ rrdtool-2003-12-11/acinclude.m4	Thu Dec 11 12:47:55 2003
@@ -6,23 +6,31 @@
 AC_DEFUN(INCLUDED_LIB,
 [
 use_installed_lib$1=
+installed_lib$1_lib=$1
+installed_lib$1_include=
+AC_ARG_WITH([lib$1-lib],[Use installed lib$1 as libNAME],installed_lib$1_lib=$withval)
+AC_ARG_WITH([lib$1-include],[Use installed lib$1 includes here],installed_lib$1_include=$withval)
 AC_ARG_WITH([lib$1],
             [AC_HELP_STRING([--with-lib$1],
                             [Use installed lib$1 (under PREFIX)])],
             [if test -n "$withval"; then
                if test "$withval" = yes; then
                  withval="default path"
+		 if test -n "$installed_lib$1_include"; then
+		   CFLAGS="$CFLAGS -I${installed_lib$1_include}"
+		 fi
                else
                  CFLAGS="$CFLAGS -I${withval}/include"
                  LDFLAGS="$LDFLAGS -L${withval}/lib"
                fi
              fi
-             AC_CHECK_LIB([$1],[$2],
+             AC_CHECK_LIB([$installed_lib$1_lib],[$2],
                           [AC_MSG_NOTICE([using lib$1 in ${withval}])
                            use_installed_lib$1=yes],
                           [AC_MSG_ERROR([lib$1 not found in ${withval}])],
                           [$3])],
              [AC_MSG_NOTICE([using included lib$1])])
+AC_SUBST([installed_lib$1_lib])
 AM_CONDITIONAL([USE_INSTALLED_lib$1],
                [test "$use_installed_lib$1" = yes])
 ])
--- rrdtool-2003-12-11/src/rrd_gfx.h.orig	Sun Oct 26 20:29:56 2003
+++ rrdtool-2003-12-11/src/rrd_gfx.h	Thu Dec 11 13:18:14 2003
@@ -7,7 +7,7 @@
 #ifndef  RRD_GFX_H
 #define RRD_GFX_H
 #define LIBART_COMPILATION
-#include <libart.h>
+#include <libart_lgpl/libart.h>
 
 enum gfx_if_en {IF_PNG=0,IF_SVG,IF_EPS,IF_PDF};
 enum gfx_en { GFX_LINE=0,GFX_AREA,GFX_TEXT };
